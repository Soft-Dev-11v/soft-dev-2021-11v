{% extends "layouts/RecipesBase.html" %}

{% block title %} RECIPIES {% endblock %} 

{% block stylesheets %}{% endblock stylesheets %}

{% block content %}


<div class="section section-lg">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-12">
                <div class="mb-5">
                    <table class="table" id = "recipietable">
                        <tbody>
                            <tr>
                                <th scope="row" id="ingredients">
                                    <form method="post" action="" class="mt-4" id = "ingredientsForm">
                                        <div class="form-group mb-4">
                                            <div class="mb-3">
                                                <label for="exampleFormControlTextarea1">Enter Ingredients</label>
                                                {{ form.ingredients(class="form-control", id="ingrform") }}
                                            </div>
                                        </div>
                                        <button class="btn btn-block btn-primary" type="submit">Get recipies</button>
                                    </form>
                                </th>
                            </tr>
                        </tbody>
                    </table>

                </div>
            </div>
        </div>
    </div>
</div>

<div class="section section-md pt-0">
    <div class="container">
        <div class="row justify-content-center mt-4">
            <div class="col-12 col-lg-8">
                <div class="accordion" id="accordionExample1">
                    <div class="accordion-item" id="headingOne">

                    </div>
                </div>
            </div> 
        </div>
    </div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.js"
          integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
          crossorigin="anonymous">
</script>
 
<script type="text/javascript">
    $(document).on('submit','#ingredientsForm',function(e)
    {
        e.preventDefault();
        $.ajax({
        type:'POST',
        url:'/Recipes.html',
        data:{
            ingredients:$("#ingrform").val()
        },
        success:function(data)
        {
            $('.accordion-header').remove();
            $('.accordion-body').remove();
            $('.accordion-collapse').remove();
            for(i in data[0]){
                var recipies = data[0][i]
                var images = data[1][i]
                var buttonRow = "<h2 class=accordion-header><button class=accordion-button type=button data-bs-toggle=collapse data-bs-target=#id" + i + " aria-expanded=true aria-controls=id" + i + ">" + recipies + "</button> </h2>";
                $('#headingOne').append(buttonRow);
                var body1 = "<div id=id" + i + " class=accordion-collapse collapse show aria-labelledby=headingOne data-bs-parent=#accordionExample1><div class=accordion-body><img src=" + images + "></div> </div>";
                $('#headingOne').append(body1);
            }
        }
        })
    });
</script>




{% endblock content %}

{% block javascripts %}{% endblock javascripts %}